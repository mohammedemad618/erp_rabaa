الخطة الرئيسية لتطوير نظام Enterprise Travel ERP
إصدار المرجع: 1.0
تاريخ المرجع: 2026-02-20
المالك: إدارة المنتج + الهندسة + العمليات

====================================================================
1) الرؤية والأهداف
====================================================================
بناء نظام إدارة سفر مؤسسي احترافي يتميز بـ:
- سهولة الاستخدام وسرعة إنجاز الطلبات للموظفين.
- حوكمة قوية للموافقات والسياسات مع امتثال عال.
- شفافية مالية كاملة للتكلفة من الطلب وحتى التسوية.
- ميزات متقدمة للتحليل والتنبؤ والأتمتة.

الأهداف التجارية الأساسية:
1. تقليل زمن دورة الطلب من الإنشاء حتى الاعتماد بنسبة 50%.
2. رفع الالتزام بالسياسات إلى 95% أو أكثر.
3. خفض الإنفاق الكلي على السفر بنسبة 10% إلى 15%.
4. تقليل الجهد اليدوي في المطابقة المالية بنسبة 40%.

====================================================================
2) مبادئ المنتج (احترافي + سهل الاستخدام)
====================================================================
1. الوضوح أولاً:
- كل شاشة تجيب على: ماذا حدث؟ ما المطلوب الآن؟ ما الخطوة التالية؟
2. أقل عدد خطوات:
- إنجاز العمليات الحرجة بأقل نقرات وحقول ممكنة.
3. تدفق موجّه:
- قيم افتراضية ذكية، تعبئة تلقائية، تحقق لحظي، إرشادات سياقية.
4. الثقة وقابلية التتبع:
- سجل تدقيق كامل، توثيق قرارات الموافقة، تفسير واضح لمخالفات السياسة.
5. قابلية التوسع:
- بنية معيارية، واجهات API مستقرة، قابلية تكامل عالية.

====================================================================
3) الأدوار الأساسية في النظام
====================================================================
1. الموظف / المسافر:
- إنشاء الطلب، متابعة الحالة، رفع الإيصالات، استلام تنبيهات السياسة.
2. المدير المباشر / المعتمد:
- مراجعة الطلب، موافقة أو رفض مع السبب، تفويض الاعتماد عند الحاجة.
3. فريق السفر / العمليات:
- إدارة الحجوزات، الموردين، الاستثناءات، ودعم حالات السفر.
4. المالية / المحاسبة:
- مراجعة المصروفات، المطابقة، إدارة مراكز التكلفة والميزانيات.
5. مدير النظام:
- إدارة الصلاحيات والسياسات وسير العمل والتكاملات وتقارير التدقيق.
6. الإدارة التنفيذية:
- متابعة لوحات الأداء، الإنفاق، الامتثال، وفورات التكلفة، والمخاطر.

====================================================================
4) النطاق الوظيفي
====================================================================
4.1 الوحدات الأساسية (MVP):
1. إدارة المستخدمين والصلاحيات:
- دعم SSO، نموذج RBAC، وتفعيل MFA اختياريًا.
2. دورة طلب السفر:
- مسودة -> إرسال -> موافقات -> حجز -> تنفيذ الرحلة -> مصروفات -> إغلاق.
3. محرك موافقات متعدد المستويات:
- التوجيه حسب قيمة الطلب، الوجهة، الدرجة الوظيفية، مركز التكلفة.
4. إدارة السياسات:
- سقوف الميزانية، حد الفندق، درجة الطيران، مهلة التقديم المسبقة.
5. إدارة الحجوزات والموردين:
- تكاملات مباشرة أو إدارة مرجع الحجز خارجيًا.
6. إدارة المصروفات والسداد:
- رفع إيصالات، بدلات يومية، تحويل عملات، متابعة حالة التعويض.
7. التكامل المالي:
- ترحيل إلى ERP، ربط الحسابات، مطابقة الفواتير.
8. الإشعارات والتنبيهات:
- بريد إلكتروني + داخل النظام + تصعيد عند تجاوز SLA.
9. التقارير ولوحات المتابعة:
- الإنفاق حسب الإدارة، نسبة الامتثال، عنق زجاجة الاعتمادات.

4.2 الوحدات المتقدمة (بعد MVP):
1. مستشار سياسات ذكي:
- اقتراح الخيار الأفضل المتوافق مع السياسة قبل الإرسال.
2. توقعات ميزانية استباقية:
- كشف خطر تجاوز الميزانية حسب الفريق والموقع والفترة الزمنية.
3. تنبيهات المخاطر والتعطّل:
- مخاطر الوجهة، تعارضات السفر، رؤية لحالات الطوارئ.
4. تقييم أداء الموردين:
- السعر، نسبة الإلغاء، جودة الخدمة.
5. أتمتة ذكية:
- اعتماد تلقائي للحالات منخفضة المخاطر، وتصعيد تلقائي عند التأخير.
6. إجراءات سريعة عبر الجوال:
- موافقة سريعة، رفع إيصال، تتبع الحالة الفوري.

====================================================================
5) المتطلبات غير الوظيفية
====================================================================
1. الأمان:
- تشفير البيانات أثناء النقل والتخزين.
- صلاحيات دقيقة وفق مبدأ أقل صلاحية.
- سجل تدقيق مقاوم للتلاعب.
2. الأداء:
- زمن استجابة الصفحات الأساسية أقل من ثانيتين.
- استقرار زمن استجابة API في العمليات الحرجة.
3. التوافر:
- نسخ احتياطي واسترجاع واضحان + مراقبة أعطال مستمرة.
4. الامتثال:
- سياسات احتفاظ البيانات، تتبع الوصول، حماية الخصوصية.
5. المراقبة التشغيلية:
- Logging + Metrics + Tracing + Alerting مركزي.
6. سهولة الصيانة:
- فصل مجالات واضح، إصدار API منظم، اختبارات آلية.

====================================================================
6) البنية التقنية الموصى بها
====================================================================
نهج التنفيذ:
1. البدء بـ Modular Monolith لتحقيق سرعة التنفيذ مع حوكمة جيدة.
2. فرض حدود المجالات من البداية:
- الهوية والوصول
- طلبات السفر
- الموافقات
- السياسات
- الحجوزات
- المصروفات
- التكامل المالي
- التقارير والتحليلات
3. تصميم API-first:
- عقود خدمات داخلية + OpenAPI موحد.
4. دعم نمط الأحداث للحالات الحرجة:
- request_submitted
- approval_granted
- trip_booked
- expense_submitted
5. خدمات مشتركة أساسية:
- Authentication
- Authorization
- Validation
- Audit Logging
- Notification Service

النموذج البياني الأساسي:
- المستخدمون، الأدوار، الإدارات، مراكز التكلفة
- السياسات وإصداراتها
- طلبات السفر ومسارات الموافقة
- خطط الرحلة وبيانات الحجز
- المصروفات والإيصالات
- الموردون والعقود
- الميزانيات واللقطات الزمنية
- أحداث التدقيق وسجلات النظام

====================================================================
7) استراتيجية تجربة المستخدم
====================================================================
1. معالج طلب سفر واضح:
- الخطوة 1: بيانات الرحلة
- الخطوة 2: فحص الميزانية والسياسة
- الخطوة 3: تأكيد الإرسال ومسار الموافقات
2. افتراضات ذكية:
- تعبئة تلقائية لبيانات الموظف والمسارات المتكررة.
3. فحص سياسة لحظي:
- إظهار المخالفة مبكرًا مع بدائل تصحيح واضحة.
4. تقليل الحمل الذهني:
- نماذج مبسطة، عناوين مفهومة، أخطاء سياقية دقيقة.
5. بحث وفرز سريع:
- للطلبات والموافقات والمصروفات والتقارير.
6. إمكانية وصول:
- دعم لوحة المفاتيح، تباين مناسب، تصميم قابل للقراءة.

مؤشرات نجاح UX:
- إكمال طلب قياسي في أقل من 5 دقائق.
- تنفيذ إجراء موافقة خلال 30 ثانية.
- نجاح المستخدم الجديد في إتمام أول طلب بنسبة 85%+.

====================================================================
8) خارطة التنفيذ الزمنية (16 أسبوع)
====================================================================
المرحلة 0: الاستكشاف والمواءمة (الأسبوع 1)
المخرجات:
1. وثيقة نطاق المنتج ومؤشرات النجاح.
2. تعريف الشخصيات وخريطة الرحلة لكل دور.
3. Backlog مرتب بالأولوية مع معايير قبول.
4. سجل المخاطر ونموذج الحوكمة.

المرحلة 1: الأساس التقني (الأسبوع 2 إلى 4)
المخرجات:
1. تأسيس RBAC والمصادقة (جاهزية SSO).
2. تصميم قواعد البيانات وخطة الترحيل.
3. خط سجل التدقيق + مراقبة تشغيلية أساسية.
4. CI/CD مع بوابات جودة واضحة.
5. عقود API للوحدات الأساسية.

المرحلة 2: التدفقات الأساسية (الأسبوع 5 إلى 10)
المخرجات:
1. دورة طلب سفر كاملة من البداية للنهاية.
2. محرك موافقات متعدد المستويات مع تصعيدات.
3. إدارة السياسات وتطبيق القواعد بشكل مباشر.
4. نظام المصروفات والتسوية الأساسية.
5. إشعارات ولوحة تحكم أولية.

المرحلة 3: الميزات المتقدمة (الأسبوع 11 إلى 14)
المخرجات:
1. مستشار سياسات ذكي.
2. تنبيهات توقعية للميزانية.
3. تحليلات أداء الموردين.
4. لوحة تنفيذية تفاعلية Drill-down.

المرحلة 4: التثبيت والإطلاق (الأسبوع 15 إلى 16)
المخرجات:
1. اختبارات أداء وأمان ومعالجة الفجوات.
2. Pilot على وحدة عمل واحدة.
3. مواد تدريب + إجراءات تشغيل قياسية.
4. اعتماد جاهزية الإنتاج Go-Live Signoff.

====================================================================
9) تنفيذ تفصيلي خطوة بخطوة
====================================================================
الخطوة 1: تأسيس الحوكمة
- تعيين Product Owner، قائد هندسة، قائد QA، مالك أمني.
- تحديد جدول قرارات وإيقاع إصدارات.
- إنشاء سجل RAID (مخاطر/افتراضات/مشاكل/اعتماديات).

الخطوة 2: تحليل المتطلبات بعمق
- جمع مشاكل العملية الحالية من الفرق الفعلية.
- توثيق قواعد السياسة الإلزامية ومسارات الاستثناء.
- قفل نطاق MVP لتفادي توسع مبكر.

الخطوة 3: تصميم المجالات والبيانات
- تعريف حدود كل Domain ومسؤولية كل فريق.
- نمذجة الكيانات وحالاتها الانتقالية.
- تصميم سجل تدقيق غير قابل للتغيير.

الخطوة 4: تجهيز المنصة
- إعداد بيئات dev/staging/production.
- تفعيل CI لفحص lint/tests/build.
- إنشاء آلية ترحيل قاعدة البيانات وإصداراتها.

الخطوة 5: خط الأساس الأمني
- سياسات جلسات وتوكن قوية.
- مصفوفة صلاحيات (من يستطيع ماذا).
- تفعيل تدقيق العمليات الحساسة.

الخطوة 6: تطوير وحدة طلب السفر
- نموذج إنشاء الطلب + حفظ مسودة + إرسال.
- دعم المرفقات مع تحقق النوع والحجم.
- خط زمني واضح لحالة الطلب.

الخطوة 7: تطوير وحدة الموافقات
- محرك قواعد لتوجيه مسار الاعتماد.
- إجراءات موافقة/رفض/تفويض.
- مؤقت SLA مع تصعيد تلقائي.

الخطوة 8: تطوير وحدة السياسات
- إدارة السياسات مع Versioning وتاريخ تفعيل.
- اختبار محاكاة قبل النشر.
- رسائل مخالفة واضحة مع خطوات التصحيح.

الخطوة 9: تطوير الحجز والمصروفات
- إدارة مراجع الحجز وخطة الرحلة.
- إنشاء مطالبة مصروفات مع رفع الإيصالات.
- حالات تدفق التعويض المالي.

الخطوة 10: التكامل المالي
- ربط بنود المصروفات بحسابات GL ومراكز التكلفة.
- بناء موصل API أو ملفات مطابقة حسب النظام المالي.
- إدارة فشل المزامنة مع آلية Retry.

الخطوة 11: التقارير والتحليلات
- إنشاء جداول KPI وتجميعات تحليلية.
- بناء لوحات للعمليات والمالية والإدارة التنفيذية.
- إعداد تنبيهات عند تجاوز حدود معرّفة.

الخطوة 12: الأتمتة المتقدمة
- اعتماد تلقائي للحالات منخفضة المخاطر.
- تنبيه استباقي لتجاوز الميزانية.
- نموذج ترشيح موردين حسب الأداء.

الخطوة 13: الجودة والاعتماد
- دورات Functional/Integration/Regression/UAT.
- اختبارات أمان للصلاحيات والتدقيق.
- اختبارات أداء تحت حمل مرتفع.

الخطوة 14: التجربة التشغيلية والتدريب
- إطلاق Pilot لمجموعة محددة.
- تحليل الملاحظات وتحسين نقاط الاحتكاك.
- تدريب المعتمدين والمالية والدعم.

الخطوة 15: الإطلاق الإنتاجي
- مراجعة نهائية Go/No-Go.
- تحميل البيانات المرجعية الأساسية.
- تفعيل Hypercare للاستجابة السريعة.

====================================================================
10) بوابات الجودة قبل الإطلاق
====================================================================
1. الأمان:
- عدم وجود ثغرات حرجة/عالية غير معالجة.
2. الاستقرار:
- نجاح المسارات الأساسية End-to-End.
3. الأداء:
- تحقيق أهداف زمن الاستجابة المحددة.
4. قابلية التدقيق:
- تتبع كل إجراء حرج مع المستخدم والتاريخ.
5. سلامة البيانات:
- عدم وجود سجلات يتيمة في التدفقات الأساسية.
6. سهولة الاستخدام:
- نجاح مستخدمي Pilot في إنجاز المهام فوق الحد المستهدف.

====================================================================
11) إطار مؤشرات الأداء (KPI)
====================================================================
مؤشرات تشغيلية:
1. متوسط زمن دورة الموافقة.
2. نسبة تجاوز SLA.
3. حجم تذاكر الدعم المرتبطة بالسفر.

مؤشرات مالية:
1. تكلفة الرحلة الواحدة.
2. تأثير مخالفات السياسة على التكلفة.
3. زمن التسوية والمطابقة المالية.

مؤشرات امتثال:
1. نسبة الالتزام بالسياسات.
2. معدل الاستثناءات المعتمدة.
3. جاهزية التدقيق الداخلي والخارجي.

مؤشرات تجربة المستخدم:
1. معدل إكمال النماذج.
2. زمن إنشاء وإرسال الطلب.
3. درجة رضا المستخدمين.

====================================================================
12) هيكل الفريق والمسؤوليات
====================================================================
إدارة المنتج:
- تحديد الأولويات، معايير القبول، وإدارة تواصل الإطلاق.

الهندسة:
- بناء الوحدات، الواجهات، التكاملات، والرصد.

ضمان الجودة QA:
- استراتيجية الاختبار، أتمتة الانحدار، إدارة عيوب UAT.

الأمن:
- Threat Modeling، فحص الضوابط، اعتماد الجاهزية الأمنية.

DevOps:
- CI/CD، إدارة البيئات، النسخ الاحتياطي، المراقبة.

الدعم والتدريب:
- تمكين المستخدمين، توثيق SOP، دعم Hypercare.

====================================================================
13) إدارة المخاطر
====================================================================
أهم المخاطر وخطة التخفيف:
1. توسع النطاق:
- التخفيف: بوابة اعتماد صارمة لتغييرات MVP.
2. تأخر التكاملات:
- التخفيف: عقود API مبكرة + بيئة Mock.
3. ضعف جودة البيانات:
- التخفيف: قواعد تحقق + تجارب استيراد مرحلية.
4. ضعف التبني من المستخدمين:
- التخفيف: مجموعة Champions + تدريب مخصص لكل دور.
5. اختناقات الأداء:
- التخفيف: اختبارات حمل مبكرة + تحسين الاستعلامات.

====================================================================
14) التوثيق والجاهزية التشغيلية
====================================================================
الوثائق الإلزامية:
1. Architecture Decision Records.
2. دليل API والتكامل.
3. دليل تشغيل المسؤول + خطة الاستجابة للحوادث.
4. أدلة استخدام حسب الدور الوظيفي.
5. ملاحظات الإصدار والقيود المعروفة.

====================================================================
15) خطة الإطلاق وما بعد الإطلاق
====================================================================
قائمة التحقق للإطلاق:
1. التحقق الكامل من ترحيل البيانات.
2. تفعيل المراقبة والتنبيهات.
3. جاهزية الدعم مع مصفوفة تصعيد.
4. خطة رجوع (Rollback) مجربة مسبقًا.

أول 30 يوم بعد الإطلاق:
1. مراجعة يومية للصحة التشغيلية والحوادث.
2. مراجعة أسبوعية لمؤشرات KPI والتحسينات.
3. ترتيب Backlog للتحسينات المتقدمة.

====================================================================
16) خطوات فورية لهذا الأسبوع
====================================================================
1. اعتماد القائمة النهائية لوحدات MVP ومعايير القبول.
2. تثبيت مصفوفة الموافقات وقواعد السياسة.
3. اعتماد حدود البنية وعقود API.
4. تجهيز Sprint Backlog لمرحلة الأساس (الأسبوع 2-4).
5. قياس Baseline للمؤشرات من العملية الحالية.

====================================================================
17) حالة التنفيذ الحالية (متابعة عملية)
====================================================================
آخر تحديث تنفيذي: 2026-02-20

1. مكتمل:
- تأسيس RBAC + تسجيل دخول + حراسة الصفحات وواجهات API.
- دورة طلب السفر الأساسية (إنشاء/إرسال/موافقات/رفض/إلغاء/تأكيد الحجز).
- محرك السياسات مع تقييم لحظي + محاكاة سياسة قبل التنفيذ.
- سجل تدقيق كامل + تصدير CSV.
- مؤشرات تشغيلية وتنفيذية (Insights) + تنبيهات SLA ومخاطر الميزانية.
- أتمتة اعتماد منخفضة المخاطر.

2. مكتمل (المرحلة الحالية الجديدة):
- وحدة الحجز: حفظ مرجع الحجز وبيانات التذكرة بعد الحجز.
- وحدة المصروفات: إنشاء مطالبة مصروفات مع بيانات الإيصال.
- مراجعة المصروفات: اعتماد/رفض من المالية مع ملاحظة.
- التكامل المالي: ترحيل المصروفات المعتمدة إلى قيود GL مع Batch ومعالجة فشل المزامنة وإعادة المحاولة.
- واجهات API كاملة لهذه العمليات + ربط واجهة المستخدم.
- إغلاق الرحلة رسميًا بعد اكتمال التسوية المالية عبر انتقال `close_trip`.
- إدارة السياسات مع Versioning (مسودة/مفعّل/مجدول) وتفعيل بتاريخ + ربط المحاكاة بإصدار سياسة محدد.

3. قيد التطوير التالي:
- توسيع إجراءات الإغلاق النهائي للرحلة بعد اكتمال التسوية المالية.
- تعزيز اختبارات التكامل والأداء والأمان حسب بوابات الجودة.
- تجهيز مواد التشغيل والتدريب وPilot.

نهاية الخطة المرجعية.

[2026-02-21 Execution Update] Trip closure procedures expanded: readiness checks API/UI added, and settlement summary is now persisted on close_trip.
[2026-02-21 QA Update] Added integration tests for travel closure readiness, pending-expense close rejection, successful close settlement persistence, and finance role-authorization guard.
[2026-02-21 Operations Update] Added pilot package: operations runbook, escalation matrix, go-live checklist, role-based training guide, and smoke-check script for pilot readiness.
[2026-02-21 Hypercare Update] Added automated daily health-report generation and 30-day hypercare execution plan with operational cadence.
[2026-02-21 Escalation Update] Support escalation matrix contacts were finalized using current demo environment role owners and emails.
[2026-02-21 Automation Update] Added hypercare automation scripts (daily combined run + task register/unregister) and communication-channel matrix for operations escalation.
[2026-02-21 IncidentOps Update] Added standardized incident ticket template and linked it in operations runbook.
[2026-02-21 Continuity Update] Added on-call rota, shift handover template, and weekly executive summary automation for pilot/hypercare governance.
[2026-02-21 Governance Update] Added automated Go/No-Go decision generation with executive sign-off framework and history tracking.
[2026-02-21 ReleaseOps Update] Added consolidated release-readiness automation (weekly summary + Go/No-Go + readiness history), integrated command wiring, expanded security integration tests, and CI now enforces lint/test/build.
[2026-02-21 RollbackOps Update] Added automated rollback-drill validation with report/history artifacts, linked it to go-live checklist and runbook, and verified successful drill execution.
[2026-02-21 QualityGate Update] Added automated performance and security gates with daily reports/history, integrated both gates into Go/No-Go and release-readiness execution flow, and updated operational/go-live documentation accordingly.
[2026-02-21 ScenarioCheck Update] Added and executed end-to-end usage scenario verification script (multi-role workflow from create to finance sync + closure readiness guard), with report/history artifacts under docs/operations/reports.
[2026-02-21 UXLayout Update] Unified enterprise page architecture (header/actionable controls/KPI/work-area/details) was applied across dashboard, travel, settings, expenses, OCR, reports, transactions, accounting, BSP, CRM, treasury, and templates, with standardized input styling and improved RTL-friendly field organization.
[2026-02-21 UXTravel Update] Travel Requests console was refactored to the universal ERP structure (PageHeader, Actionable Controls, Insights section, KPI grid, and 12-column main workspace), reducing scattered controls and improving form readability for RTL/LTR usage.
[2026-02-21 BilingualUX Update] Transactions workbench hardcoded operational copy was localized for Arabic/English (hotkey toasts, table paging labels, row summary, metadata labels, and empty-state text) to keep language switching consistent.
[2026-02-21 TravelRestructure Update] Travel Requests UI was fully restructured: creation form converted to guided 3-step flow, request details converted to focused tabbed views (overview/operations/workflow/audit), and action hierarchy was aligned to enterprise layout zones to reduce cognitive load.
[2026-02-21 TravelTableUX Update] Travel requests list now includes status quick-filters, paginated table navigation, and real-time row/match counters; this reduces scanning load and keeps large datasets manageable for non-technical users.
[2026-02-21 TravelSelection UX Update] Request detail panel selection is now constrained to the currently filtered dataset to prevent hidden/off-filter records from appearing during review.
[2026-02-21 SecurityHardening Update] Phase 0 security access controls were enforced across all ERP modules: centralized route-permission mapping added, server-side page guards applied to all locale pages, non-travel APIs (sales transition and OCR extract) are now permission-protected, and proxy API authentication scope was expanded beyond travel-only routes.
[2026-02-21 I18N+Validation Update] Phase 1 reliability baseline started: login/forbidden/logout copy centralized into next-intl messages for consistent Arabic/English switching, shared safe JSON body parser introduced for API POST handlers, and regression tests added for i18n integrity plus malformed JSON handling.
[2026-02-21 I18NExpansion Update] Phase 1 localization expansion completed for transactions/reports/treasury: actionable section labels, KPI/table/pagination copy, simulation/heatmap notes, loading text, and operational hotkey messages are now fully served from centralized next-intl keys in Arabic/English.
[2026-02-21 TravelIndicators Move Update] Executive indicators (compliance, blocked rate, lead time, approval cycle, SLA breaches, budget risks) were moved from Travel Requests to Reports, including bilingual labels and centralized i18n keys.
[2026-02-21 Transactions Restructure Update] Transactions module was fully restructured for enterprise usability: priority queue bar with live counts, rows-per-page control, cleaner table focus area, and a redesigned detail side panel (summary + quick actions + audit + hotkeys) with full Arabic/English localization support.
[2026-02-21 HydrationFix Update] Fixed SSR/client hydration mismatch in currency cells by making runtime currency/exchange-rate resolution deterministic for first render (dataset-only snapshot), and triggering a post-mount settings refresh event for consistent client re-rendering.
[2026-02-21 Transactions LayoutFix Update] Fixed section placement in Transactions for RTL by adding controllable split ordering in ErpMainSplit and rendering details panel first in Arabic; removed sticky behavior on side panel to prevent floating/blank-main perception while scrolling.
